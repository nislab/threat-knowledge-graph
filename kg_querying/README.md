## Analyzing CVE-CWE and CVE-CPE mapping removals from the NVD, using Knowledge Graph embeddings, querying and scoring. 

In this repository you'll find three different tutorials, along with their results. 

In [ampligraph_removed.md](https://github.com/nislab/threat-knowledge-graph/blob/main/kg_querying/ampligraph_removed.md) you can find the methods that build on top of the knowledge graph construction and training, that aims to give an example of how we use the knowledge graph inference to distinguish correct triples from erroneous triples. Moreover, in the same document, we also showcase that the querying function of the embedding model successfully predicts the correct CWE mapping for a given CVE, among the top 10 positions. To generalize our results, we lastly show the top 20 matches for each CVE that had a CWE mapping update between August 2021 and November 2022, and we validate our results by comparing the query results to the actual updated CWE mapping. This tutorial uses ampligraph python package, along with common libraries such as pandas, numpy and sklearn. 

In [Property_Querying_Tutorial.ipynb](https://github.com/nislab/threat-knowledgegraph/blob/main/kg_querying/Property_Querying_Tutorial.ipynb), we demonstrate our method for querying the properties of removed and non-removed triples and compare the the resulting differences between the sets. The tutorial uses the Neo4j python API to query the knowledge graph and ultimately store the data in .xlsx files. Subsequently, our evaluation of the results obtained from this tutorial can be found [here](https://github.com/nislab/threat-knowledge-graph/blob/main/kg_querying/Property_Querying_Results.ipynb).

